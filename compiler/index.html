<html>
<head>
  <title>t7 Compiler</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="codemirror.css">
  <link rel="stylesheet" href="style.css">
  <script src="codemirror.js"></script>
  <script src="active-line.js"></script>
  <script src="matchbrackets.js"></script>
  <script src="javascript.js"></script>
  <script src="special-t7.js"></script>
</head>
<body>
  <div class="container" id="compiler">
    <header>
      <h1>t7.js Compiler</h1>
      <p>This tool demonstrates how t7 template strings are transformed into native JavaScript objects.</p>
    </header>
    <div class="main">
      <div class="left-side">
        <div class="content">
          <form><textarea id="code1" name="code"></textarea></form>
        </div>
      </div>
      <div class="right-side">
        <div class="content">
          <form><textarea id="code2" name="code"></textarea></form>
        </div>
      </div>
    </div>
  </div>
  <script>
    function compileReturn(val) {
      if(val != "") {
        editor2.setValue(val);
      }
    }

    function getLiterals(code) {
      var literals = code.match(/\${(.*)}/g);
      debugger;
    }

    var editor = CodeMirror.fromTextArea(document.getElementById("code1"), {
      mode: 'javascript',
      lineNumbers: true,
      styleActiveLine: true,
      matchBrackets: true,
      smartIndent: true,
      theme: "monokai"
    });

    var editor2 = CodeMirror.fromTextArea(document.getElementById("code2"), {
      mode: 'javascript',
      lineNumbers: true,
      matchBrackets: true,
      smartIndent: true,
      lineWrapping: false,
      readOnly: true,
      theme: "monokai"
    });

    editor.on('change', function(editor) {
      var code = editor.getValue();
      var failed = false;
      var output = {};
      try {
        //get the variables
        getLiterals(code);
        eval("compileReturn(" + code + ")");
      } catch(e) {
        failed = true;
      }
    });
  </script>

  </script>
</body>
</html>
